{% extends "!layout.html" %}


{% block menu %}
<button id="donate-button" class="donate-btn-form" style="margin-top: -10px !important; display: none;">Donate</button>
<div id="payment-request-button" style="margin-top: -10px;"></div>
<div id="payment-form-container" style="margin-bottom: 1em; margin-top: -10px; background: #fff; display: none;">
    <form id="payment-form"
          style="display: flex; align-items: center; justify-content: center; flex-direction: column; padding: 10px 7px; width: 100%;">
        <div id="card-element" style="width: 100%"></div>
        <div id="card-errors" role="alert" style="width: 100%; display: none; font-weight: 300; color: red;font-size: .7rem;
    margin-top: 10px;"></div>
    </form>
    <button id="submit-donate" class="donate-btn-form" style="margin-top: 1rem;">Donate $3</button>
</div>
{{ super() }}
<div style="display: flex; height: 100%; flex-direction: column;">


    <div style="margin-top: 5em; width: 100%; height: 4rem; z-index: 999; display: flex; flex-direction: column; padding: 5px">
        <span style="font-size: 1rem; color: white">Do you have questions?</span>
        <span id="slack-btn"
              style="width:100%; display: flex; align-items: center; margin-top: 1em; cursor: pointer">
       <img src="https://img.shields.io/badge/slack-ask%20on%20slack-orange?style=for-the-badge&logo=slack">
    </span>
    </div>
    <div style="margin-top: 1.5em; width: 100%; height: 4rem; z-index: 999; display: flex; flex-direction: column; padding: 5px">
        <!-- Place this tag where you want the button to render. -->
        <div style="display: flex; align-items: center;">
            <!-- Place this tag where you want the button to render. -->
            <a class="github-button" href="https://github.com/saleweaver/python-amazon-sp-api"
               data-color-scheme="no-preference: dark_high_contrast; light: light; dark: dark_high_contrast;"
               data-icon="octicon-star" data-show-count="true"
               aria-label="Star saleweaver/python-amazon-sp-api on GitHub">Star</a>
            <a style="margin-left: 5px" class="github-button"
               href="https://github.com/saleweaver/python-amazon-sp-api/fork"
               data-color-scheme="no-preference: dark_high_contrast; light: light; dark: dark_high_contrast;"
               data-icon="octicon-repo-forked" data-show-count="true"
               aria-label="Fork saleweaver/python-amazon-sp-api on GitHub">Fork</a>
            <!-- Place this tag where you want the button to render. -->
            <a style="margin-left: 5px" class="github-button" href="https://github.com/sponsors/saleweaver"
               data-color-scheme="no-preference: dark_high_contrast; light: light; dark: dark_high_contrast;"
               data-icon="octicon-heart" aria-label="Sponsor @saleweaver on GitHub">Sponsor</a>
        </div>
        <!-- Place this tag where you want the button to render. -->
        <div style="display: flex; align-items: center;">
            <a class="github-button" href="https://github.com/saleweaver/python-amazon-sp-api/discussions"
               data-color-scheme="no-preference: dark_high_contrast; light: light; dark: dark_high_contrast;"
               data-icon="octicon-comment-discussion"
               aria-label="Discuss saleweaver/python-amazon-sp-api on GitHub">Discuss</a>
            <!-- Place this tag where you want the button to render. -->
            <a style="margin-left: 5px" class="github-button"
               href="https://github.com/saleweaver/python-amazon-sp-api/issues"
               data-color-scheme="no-preference: dark_high_contrast; light: light; dark: dark_high_contrast;"
               data-icon="octicon-issue-opened" data-show-count="true"
               aria-label="Issue saleweaver/python-amazon-sp-api on GitHub">Issue</a>
        </div>
        <span id="git-btn"
              style="width:100%; display: flex; align-items: center; margin-top: 1em; cursor: pointer">
        <img src="https://img.shields.io/badge/github-view%20on%20github-silver?style=for-the-badge&logo=github">
        </span>
    </div>

</div>
<script>
    const link = (link) => {
        const el = document.createElement('a');
        el.href = link;
        el.target = '_blank';
        el.click();
    }
    document.getElementById('slack-btn').addEventListener('click', () => {
        window.analytics.track('SLACK', {
            action: 'askOnSlack',
            title: document.title,
            page: document.location.href
        });
        link("https://join.slack.com/t/sellingpartnerapi/shared_invite/zt-zovn6tch-810j9dBPQtJsvw7lEXSuaQ");
    })

    document.getElementById('git-btn').addEventListener('click', () => {
        window.analytics.track('GITHUB', {
            action: 'viewOnGithub',
            title: document.title,
            page: document.location.href
        });
        link("https://github.com/saleweaver/python-amazon-sp-api");
    })
</script>
{% endblock %}


{% block content %}
<div id="extra-content">

</div>
        
        
        
        
        
        
        
        <!--SPLIT HERE INSERT ADS <TEMPLATES>-->
        
        <div style="display: none;" id="45265">
        <a href="https://www.digistore24.com/redir/511393/saleweaver/" target="_blank" rel="noopener noreferrer" style="text-decoration: none; color: inherit;">
  <div style="display: flex; flex-direction: row; align-items: center; background-color: #f0f8ff; padding: 20px; border-radius: 8px;">
    <img src="../_static/images/815da4f3df064233ae798d61d683dda1.png" onerror="this.src = '_static/images/815da4f3df064233ae798d61d683dda1.png'" alt="AI Digital Artist Masterclass" style="width: 256px; height: 448px; margin-right: 20px;">
    <div>
      <h2 style="color: #1E90FF; margin-top: 0;">🎨 Unleash Your Creativity with AI!</h2>
      <p>Join over a million artists transforming their skills with <strong>Digistore's Complete AI Digital Artist Masterclass</strong>. Elevate your artistry by mastering generative AI techniques, accessing exclusive source code, and engaging in practical projects. Future-proof your career in the evolving digital art landscape.</p>
      <ul style="list-style: none; padding: 0; margin: 10px 0;">
        <li>✨ <strong>Master AI Tools:</strong> Revolutionize your creative process.</li>
        <li>💻 <strong>Exclusive Code:</strong> Hands-on projects to enhance your portfolio.</li>
        <li>🚀 <strong>Future-Proof Skills:</strong> Thrive in a tech-driven art world.</li>
      </ul>
      <p style="margin-bottom: 0;">👉 <strong>Enroll now</strong> and transform your artistic journey!</p>
    </div>
  </div>
</a>
        </div>
         
        
        
        <div style="display: none;" id="30133">
        <a href="https://www.digistore24.com/redir/271198/saleweaver/" target="_blank" style="display: block; text-decoration: none; color: inherit;">
  <div style="display: flex; align-items: center; background-color: #e6f2ff; padding: 20px; border-radius: 8px;">
    <img src="../_static/images/bfb7a8859c53401db3ccd3a27a48e6ea.png" alt="Raspberry Pi Course" style="width: 256px; height: 448px; margin-right: 20px;" onerror="this.src = '_static/images/bfb7a8859c53401db3ccd3a27a48e6ea.png'" />
    <div>
      <h2 style="color: #0066cc; margin-top: 0;">🚀 Unlock Your Raspberry Pi Potential!</h2>
      <p style="color: #333;">Embark on an exciting journey with our <strong>Raspberry Pi Video Course for Beginners</strong> and turn your ideas into reality!</p>
      <ul style="list-style: none; padding: 0; color: #333;">
        <li>📚 <strong>25 Video Lessons:</strong> From setup to advanced projects.</li>
        <li>🖥️ <strong>All Models Welcome:</strong> Pi 4, 3, 2, and Zero covered.</li>
        <li>🎓 <strong>Expert Guidance:</strong> Learn with instructor Axel.</li>
        <li>💡 <strong>Free Trial:</strong> Start with 4 free lessons.</li>
        <li>✅ <strong>Money-Back Guarantee:</strong> 60-day risk-free.</li>
      </ul>
      <p style="color: #0066cc; font-weight: bold;">👉 Click here to get started today!</p>
    </div>
  </div>
</a>
        </div>
         
        
        
        <div style="display: none;" id="43962">
        <a href="https://www.digistore24.com/redir/497855/saleweaver/" target="_blank" style="text-decoration: none;">  <div style="display: flex; flex-wrap: wrap; align-items: center; background-color: #e6f2ff; border: 1px solid #99ccff; padding: 12px; border-radius: 6px;">    <img src="../_static/images/33d0dab07d52479e9e4fcc21ff17e9d5.png" alt="Masterclass Mastery" style="width: 256px; height: 448px; max-width: 100%; margin-right: 12px; flex-shrink: 0;" onerror="this.src = '_static/images/33d0dab07d52479e9e4fcc21ff17e9d5.png'">    <div style="flex: 1; color: #003366;">      <h2 style="margin: 0 0 8px 0;">🎓 Launch Your Online Course in 30 Days! 🚀</h2>      <p style="margin: 0 0 8px 0;">Unlock your potential with <strong>Masterclass Mastery</strong>—the all-in-one solution to create and launch high-quality online courses.</p>      <ul style="list-style: none; padding: 0; margin: 0 0 8px 0;">        <li>🌟 <strong>Step-by-Step Guide</strong></li>        <li>💪 <strong>Boost Confidence</strong></li>        <li>💰 <strong>Budget-Friendly Tools</strong></li>        <li>🎥 <strong>8 Hours of Videos</strong></li>        <li>📚 <strong>Interactive Materials</strong></li>        <li>🌐 <strong>Global Audience</strong></li>        <li>💼 <strong>Establish Expertise</strong></li>        <li>🔒 <strong>30-Day Guarantee</strong></li>      </ul>      <p style="margin: 0;"><strong>Don't wait to turn your passion into profit.</strong> Enroll now and transform your knowledge into a thriving online business!</p>    </div>  </div></a>
        </div>
         
        
        
        <div style="display: none;" id="45267">
        <a href="https://www.digistore24.com/redir/509295/saleweaver/" target="_blank" style="text-decoration: none; color: inherit;">
  <div style="display: flex; flex-wrap: wrap; align-items: center; background-color: #e6f2ff; padding: 15px; border: 1px solid #b3daff; border-radius: 8px; max-width: 800px; margin: auto;">
    <img src="../_static/images/3e168715082642cd9fee10f38dc6e004.png" alt="Python, Machine Learning & AI Mega Bundle+" style="width: 256px; height: 448px; object-fit: cover; margin: 0 auto;" onerror="this.src = '_static/images/3e168715082642cd9fee10f38dc6e004.png'">
    <div style="flex: 1; padding-left: 15px;">
      <h2 style="color: #004080;">🚀 Unlock Your Future with The Complete Python, Machine Learning & AI Mega Bundle+! 🚀</h2>
      <ul style="list-style: none; padding: 0; color: #003366;">
        <li>📚 <strong>Comprehensive Learning</strong>: Self-paced courses for all levels.</li>
        <li>🎥 <strong>Interactive Tutorials</strong>: Easy-to-understand video lessons.</li>
        <li>💻 <strong>Hands-On Projects</strong>: Build real-world projects for your portfolio.</li>
        <li>📝 <strong>Ready-to-Use Templates</strong>: Start coding with expert-designed templates.</li>
        <li>🌟 <strong>Essential Skills</strong>: Master Machine Learning & AI techniques.</li>
      </ul>
      <p style="margin-top: 10px; color: #003366;">Join over <strong>1,000,000 satisfied students</strong> and transform your career today!</p>
      <button style="background-color: #0066cc; color: #ffffff; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; font-size: 16px; margin-top: 10px;">Get Started Now</button>
    </div>
  </div>
</a>
        </div>
         
        
        
        <div style="display: none;" id="45263">
        <a href="https://www.digistore24.com/redir/511400/saleweaver/" target="_blank" style="text-decoration: none; color: inherit;">
  <div style="display: flex; flex-wrap: wrap; background-color: #f0f8ff; padding: 15px; border: 1px solid #cce0ff; border-radius: 10px;">
    <img src="../_static/images/15df61f856834dd2a935d78ca80930d3.png" alt="Game Development Bundle" style="width: 256px; height: 448px; margin-right: 15px; flex-shrink: 0;" onerror="this.src = '_static/images/15df61f856834dd2a935d78ca80930d3.png'">
    <div style="flex: 1;">
      <h2 style="color: #004aad; margin-top: 0;">🎮🚀 Unlock Your Game Development Potential! 🚀🎮</h2>
      <p style="color: #333;">Elevate your skills with the <strong>Complete Unity/Unreal/Godot ChatGPT, AI, Development Bundle+</strong>. Master top engines, integrate AI, and create immersive games.</p>
      <ul style="color: #333; list-style: none; padding-left: 0;">
        <li>🔹 <strong>Master Unity, Unreal, and Godot</strong></li>
        <li>🤖 <strong>Integrate advanced AI techniques</strong></li>
        <li>🎁 <strong>Access pre-made assets & source code</strong></li>
        <li>🕒 <strong>Learn at your own pace</strong></li>
        <li>🌐 <strong>Join a community of developers</strong></li>
      </ul>
      <p style="color: #333; font-weight: bold;">👉 Enroll today and build the future of gaming!</p>
    </div>
  </div>
</a>
        </div>
         

         
        
        
        <div style="display: none;" id="47386">
        <a href="https://tubemagic.com/ds#aff=saleweaver" target="_blank" style="text-decoration:none; color:inherit;">
  <div style="display:flex; flex-wrap:wrap; background-color:#f0f8ff; padding:15px; border-radius:8px;">
    <img src="../_static/images/8627ad626d39430f8e105fe67a021167.png" alt="TubeMagic" style="width:256px; height:448px; margin-right:15px; flex-shrink:0;" onerror="this.src = '_static/images/8627ad626d39430f8e105fe67a021167.png'">
    <div style="flex:1; display:flex; flex-direction:column; justify-content:center;">
      <h2 style="color:#1e90ff; margin-top:0;">🚀 Supercharge Your YouTube Channel with TubeMagic!</h2>
      <p style="color:#000080; margin:0;">
        Ready to elevate your YouTube channel? Join thousands of creators using <strong>TubeMagic</strong> to boost growth effortlessly! For just $47/month, unlock:
      </p>
      <ul style="margin-top:5px; color:#000080; padding-left:20px;">
        <li>✨ <strong>Unlimited Video Ideas</strong>: Never run out of content.</li>
        <li>📝 <strong>Instant Script Generation</strong>: Craft scripts in seconds.</li>
        <li>🔍 <strong>Optimized Titles &amp; Descriptions</strong>: Boost SEO effortlessly.</li>
        <li>📈 <strong>Advanced Keyword Research</strong>: Stay ahead of trends.</li>
        <li>🌐 <strong>Multilingual Support</strong>: Reach a global audience.</li>
      </ul>
      <p style="color:#000080; margin:0;">
        Focus on creating great content while TubeMagic handles the rest. Try it risk-free with our 30-day money-back guarantee. <strong>Start your free trial today and transform your YouTube success!</strong>
      </p>
    </div>
  </div>
</a>
        </div>
         
        

<div style="display: none" id="tubemagic1">
<a href="https://tubemagic.com/ds#aff=saleweaver" target="_blank" style="text-decoration:none; color:inherit;">
  <div style="display:flex; flex-wrap:wrap; background-color:#f0f8ff; padding:15px; border-radius:8px;">
    <img src="../_static/images/tubemagic.png" alt="TubeMagic" style="width:256px; height:448px; margin-right:15px; flex-shrink:0;" onerror="this.src = '_static/images/tubemagic.png'">
    <div style="flex:1; display:flex; flex-direction:column; justify-content:center;">
      <h2 style="color:#1e90ff; margin-top:0;">🚀 Supercharge Your YouTube Channel with TubeMagic!</h2>
      <p style="color:#000080; margin:0;">
        Ready to elevate your YouTube channel? Join thousands of creators using <strong>TubeMagic</strong> to boost growth effortlessly! For just $47/month, unlock:
      </p>
      <ul style="margin-top:5px; color:#000080; padding-left:20px;">
        <li>✨ <strong>Unlimited Video Ideas</strong>: Never run out of content.</li>
        <li>📝 <strong>Instant Script Generation</strong>: Craft scripts in seconds.</li>
        <li>🔍 <strong>Optimized Titles &amp; Descriptions</strong>: Boost SEO effortlessly.</li>
        <li>📈 <strong>Advanced Keyword Research</strong>: Stay ahead of trends.</li>
        <li>🌐 <strong>Multilingual Support</strong>: Reach a global audience.</li>
      </ul>
      <p style="color:#000080; margin:0;">
        Focus on creating great content while TubeMagic handles the rest. Try it risk-free with our 30-day money-back guarantee. <strong>Start your free trial today and transform your YouTube success!</strong>
      </p>
    </div>
  </div>
</a>
</div>
<div style="display: none" id="tubemagic2">
    <a href="https://tubemagic.com/ds#aff=saleweaver" target="_blank" style="text-decoration: none; color: inherit;">
  <div style="display: flex; flex-wrap: wrap; align-items: center; background-color: #e6f2ff; padding: 10px; border-radius: 8px;">
    <img src="../_static/images/tubemagic.png" alt="TubeMagic" width="256" height="448" style="max-width: 100%; height: auto; margin-right: 10px;" onerror="this.src = '_static/images/tubemagic.png'">
    <div style="flex: 1; min-width: 200px;">
      <h2 style="color: #1e90ff; margin: 0;">🚀 Unlock Your YouTube Potential with TubeMagic! 🚀</h2>
      <ul style="color: #333; padding-left: 20px; margin: 10px 0;">
        <li>✨ <strong>Unlimited Video Ideas</strong> tailored to your niche</li>
        <li>📝 <strong>Optimized Titles, Descriptions & Tags</strong> for better SEO</li>
        <li>📜 <strong>Instant Script Generation</strong> to elevate your content</li>
        <li>⚡ <strong>Automate & Optimize</strong> your workflow</li>
        <li>📈 Increase <strong>Views & Subscribers</strong> efficiently</li>
      </ul>
      <p style="color: #1e90ff; font-weight: bold; margin: 0;">👉 Sign Up Now and experience effortless growth!</p>
    </div>
  </div>
</a>
</div>
<div style="display: none" id="hellocoding">
    <a href="https://www.digistore24.com/redir/511379/saleweaver/" target="_blank" style="text-decoration:none; color:inherit;">
  <div style="display:flex; flex-wrap:wrap; align-items:center; border:1px solid #ccc; border-radius:8px; padding:16px; background-color:#f0f8ff;">
    <img src="../_static/images/hellocoding.png" alt="Hello Coding" style="width:256px; height:448px; object-fit:cover; margin-right:16px;" onerror="this.src = '_static/images/hellocoding.png'">
    <div style="flex:1;">
      <h2 style="color:#1E90FF;">🚀 Unlock Your Tech Future with Hello Coding!</h2>
      <p style="color:#000;">
        Transform your career with <strong>Hello Coding – Anyone Can Learn to Code</strong>, the ultimate online course bundle. Master essential skills in <strong>web development</strong>, <strong>Python</strong>, <strong>app development</strong>, <strong>machine learning</strong>, <strong>AI</strong>, <strong>Blockchain</strong>, <strong>Web3</strong>, and <strong>game development</strong>.
      </p>
      <ul style="color:#000; padding-left:20px; list-style-type: disc;">
        <li><strong>Comprehensive 550-Hour Curriculum:</strong> Extensive learning covering key tech areas.</li>
        <li><strong>Flexible Self-Paced Learning:</strong> Learn whenever it suits you best.</li>
        <li><strong>Hands-On Projects:</strong> Build real-world applications.</li>
        <li><strong>Expert Insights:</strong> Guidance from industry professionals.</li>
        <li><strong>Join a Thriving Community:</strong> Over 1 million satisfied learners.</li>
      </ul>
      <h3 style="color:#1E90FF;">🎓 Start Your Coding Journey Now!</h3>
    </div>
  </div>
</a>
</div>
<script>
     // An array of template IDs
  // const templateIds = ["tubemagic1", "tubemagic2", "hellocoding", '47386', '45263', '45267', '43962', '30133', '45265'];

  const templateIds = ["tubemagic1", "tubemagic2", '43962', '30133'];
  // Randomly pick one template ID
  const randomIndex = Math.floor(Math.random() * templateIds.length);
  const chosenId = templateIds[randomIndex];

  // Hide all templates first (optional step to ensure a clean state)
  templateIds.forEach(id => {
    const element = document.getElementById(id);
    if (element) {
      element.style.display = "none";
    }
  });

  // Show the chosen template
  const chosenElement = document.getElementById(chosenId);
  if (chosenElement) {
    chosenElement.style.display = "block";
    chosenElement.style.marginBottom = '1em';
  }
</script>

{{ super() }}
{% endblock %}


{% block footer %}
{{ super() }}
<div style="position: fixed; bottom: 2em; right: 2em; padding: 15px; background: #134113; border-radius: 10px; color: white; display: none;"
     id="thank-you-pay">
    Thank you for your donation!
</div>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-WXLCV6BS2G"></script>
<script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
        dataLayer.push(arguments);
    }

    gtag('js', new Date());

    gtag('config', 'G-WXLCV6BS2G');
</script>
<script>
    !function () {
        var analytics = window.analytics = window.analytics || [];
        if (!analytics.initialize) if (analytics.invoked) window.console && console.error && console.error("Segment snippet included twice."); else {
            analytics.invoked = !0;
            analytics.methods = ["trackSubmit", "trackClick", "trackLink", "trackForm", "pageview", "identify", "reset", "group", "track", "ready", "alias", "debug", "page", "once", "off", "on", "addSourceMiddleware", "addIntegrationMiddleware", "setAnonymousId", "addDestinationMiddleware"];
            analytics.factory = function (e) {
                return function () {
                    var t = Array.prototype.slice.call(arguments);
                    t.unshift(e);
                    analytics.push(t);
                    return analytics
                }
            };
            for (var e = 0; e < analytics.methods.length; e++) {
                var key = analytics.methods[e];
                analytics[key] = analytics.factory(key)
            }
            analytics.load = function (key, e) {
                var t = document.createElement("script");
                t.type = "text/javascript";
                t.async = !0;
                t.src = "https://cdn.segment.com/analytics.js/v1/" + key + "/analytics.min.js";
                var n = document.getElementsByTagName("script")[0];
                n.parentNode.insertBefore(t, n);
                analytics._loadOptions = e
            };
            analytics._writeKey = "0wsJVJMN1I1p2I8Qj10csISdRgR65IHn";
            ;analytics.SNIPPET_VERSION = "4.15.3";
            analytics.load("0wsJVJMN1I1p2I8Qj10csISdRgR65IHn");
            analytics.page();
        }
    }();
</script>
<script>
    const el = document.getElementById('redoc-btn');
    if (el) {
        el.addEventListener('click', (e) => {
            window.analytics.track('REDOC', {action: 'open', page: document.location.href, title: document.title});
            const el = document.createElement('a');
            el.target = '_blank';
            el.href = e.target.getAttribute('data-href');
            el.click();
        });
    }
</script>
<script src="https://js.stripe.com/v3/"></script>
<script>

    const thankYouToastPay = document.getElementById('thank-you-pay');
    const showThankYouPay = (hide = false) => {
        thankYouToastPay.style.display = hide ? 'none' : 'block';
        link('https://sp-api-docs.saleweaver.com/thank-you-donation');
    }

    const url = 'https://u7kb21h077.execute-api.eu-central-1.amazonaws.com/staging/paymentintents';
    const stripe = Stripe('pk_live_5VpoyMNPPGbkELJSJQW0ocmr');
    const elements = stripe.elements();

    let displayError = document.getElementById('card-errors');
    const donateBtn = document.getElementById('donate-button');
    const paymentFormContainer = document.getElementById('payment-form-container');

    donateBtn.addEventListener('click', () => {
        window.analytics.track('PAYMENT', {
            action: 'donate_form_button_click',
            title: document.title,
            page: document.location.href
        })
        paymentFormContainer.style.display = 'block';
        donateBtn.style.display = 'none';
        const style = {
            base: {}
        };
        const card = elements.create("card", {style: style});
        card.mount("#card-element");
        card.on('change', ({error}) => {
            if (error) {
                displayError.style.display = 'block';
                displayError.textContent = error.message;
            } else {
                displayError.style.display = 'none';
                displayError.textContent = '';
            }
        });

        const submitDonateBtn = document.getElementById('submit-donate');
        submitDonateBtn.addEventListener('click', async (ev) => {
            window.analytics.track('PAYMENT', {
                action: 'start_payment',
                title: document.title,
                page: document.location.href
            });

            window.analytics.track('PAYMENT', {
                action: 'paymentmethod',
                title: document.title,
                page: document.location.href
            });
            submitDonateBtn.setAttribute('disabled', 'true');
            submitDonateBtn.style.pointerEvents = 'none';
            ev.preventDefault();
            // If the client secret was rendered server-side as a data-secret attribute
            // on the <form> element, you can retrieve it here by calling `form.dataset.secret`
            const intent = await fetch(url).then(e => e.json())
            const clientSecret = intent.client_secret;

            const result = await stripe.confirmCardPayment(clientSecret, {
                payment_method: {
                    card: card
                }
            });
            if (result.error) {
                // Show error to your customer (for example, insufficient funds)
                console.log(result.error.message);
                displayError.style.display = 'block';
                displayError.textContent = result.error.message;
                submitDonateBtn.setAttribute('disabled', 'false');
                submitDonateBtn.style.pointerEvents = 'all';
            } else {
                displayError.style.display = 'none';

                // The payment has been processed!
                if (result.paymentIntent.status === 'succeeded') {
                    window.analytics.track('PAYMENT', {
                        action: 'success',
                        title: document.title,
                        page: document.location.href
                    });
                    displayError.style.display = 'block';
                    displayError.style.color = 'green';
                    displayError.textContent = 'Thank you for your donation!';
                    donateBtn.style.display = 'flex';
                    paymentFormContainer.style.display = 'none';
                    showThankYouPay();
                }
                if (result.paymentIntent.status === "requires_action") {
                    // Let Stripe.js handle the rest of the payment flow.
                    let {error} = await stripe.confirmCardPayment(clientSecret);
                    if (error) {
                        submitDonateBtn.setAttribute('disabled', 'false');
                        submitDonateBtn.style.pointerEvents = 'all';
                        window.analytics.track('PAYMENT', {
                            action: 'failure',
                            title: document.title,
                            page: document.location.href,
                            ...error,
                        })
                        displayError.style.display = 'block';
                        displayError.textContent = error.message;
                    } else {
                        displayError.style.display = 'none';

                        window.analytics.track('PAYMENT', {
                            action: 'success',
                            title: document.title,
                            page: document.location.href
                        });
                        displayError.style.display = 'block';
                        displayError.style.color = 'green';
                        displayError.textContent = 'Thank you for your donation!';
                        showThankYouPay();
                        donateBtn.style.display = 'flex';
                        paymentFormContainer.style.display = 'none';
                    }
                }
            }
        });
    });


    const paymentRequest = stripe.paymentRequest({
        country: 'US',
        currency: 'usd',
        total: {
            label: 'Donation | Thank you!',
            amount: 300,
        },
        requestPayerName: true
    });
    const prButton = elements.create('paymentRequestButton', {
        paymentRequest,
        style: {
            paymentRequestButton: {
                type: 'donate',
                // One of 'default', 'book', 'buy', or 'donate'
                // Defaults to 'default'
                theme: 'dark'
                // One of 'dark', 'light', or 'light-outline'
                // Defaults to 'dark'
            },
        },
    });

    (async () => {
        // Check the availability of the Payment Request API first.
        const result = await paymentRequest.canMakePayment();
        if (result) {
            donateBtn.style.display = 'none';
            window.analytics.track('PAYMENT', {
                action: 'visible',
                title: document.title,
                page: document.location.href
            })
            prButton.mount('#payment-request-button');
            prButton.on('click', function (event) {
                window.analytics.track('PAYMENT', {
                    action: 'clicked_button',
                    title: document.title,
                    page: document.location.href
                })
            });
        } else {
            donateBtn.style.display = 'flex';
            document.getElementById('payment-request-button').style.display = 'none';
            window.analytics.track('PAYMENT', {
                action: 'not_available',
                title: document.title,
                page: document.location.href
            })
        }
    })();

    paymentRequest.on('paymentmethod', async (ev) => {
        window.analytics.track('PAYMENT', {
            action: 'paymentmethod',
            title: document.title,
            page: document.location.href
        })
        // Confirm the PaymentIntent without handling potential next actions (yet).
        const intent = await fetch(url).then(e => e.json())
        const clientSecret = intent.client_secret;
        const {paymentIntent, error: confirmError} = await stripe.confirmCardPayment(
            clientSecret,
            {payment_method: ev.paymentMethod.id},
            {handleActions: false}
        );
        if (confirmError) {
            // Report to the browser that the payment failed, prompting it to
            // re-show the payment interface, or show an error message and close
            // the payment interface.
            ev.complete('fail');
        } else {
            // Report to the browser that the confirmation was successful, prompting
            // it to close the browser payment method collection interface.
            ev.complete('success');
            // Check if the PaymentIntent requires any actions and if so let Stripe.js
            // handle the flow. If using an API version older than "2019-02-11"
            // instead check for: `paymentIntent.status === "requires_source_action"`.
            if (paymentIntent.status === "requires_action") {
                // Let Stripe.js handle the rest of the payment flow.
                const {error} = await stripe.confirmCardPayment(clientSecret);
                if (error) {
                    window.analytics.track('PAYMENT', {
                        action: 'failure',
                        title: document.title,
                        page: document.location.href,
                        ...error,
                    })

                    // The payment failed -- ask your customer for a new payment method.
                } else {
                    window.analytics.track('PAYMENT', {
                        action: 'success',
                        title: document.title,
                        page: document.location.href
                    })
                    showThankYouPay();
                }
            } else {
                window.analytics.track('PAYMENT', {
                    action: 'success',
                    title: document.title,
                    page: document.location.href
                })
                showThankYouPay();
            }
        }

    });


</script>
<!-- Place this tag in your head or just before your close body tag. -->
<script async defer src="https://buttons.github.io/buttons.js"></script>
{% endblock %}
